# name: test/sql/mobilityduck.test
# description: test mobilityduck extension
# group: [sql]

# Require statement will ensure this test is run with this extension loaded
require mobilityduck

# Test extension

# TINT() with only date
query I
SELECT TINT(42, '2023-01-01'::TIMESTAMPTZ) as tint;
----
42@2023-01-01 00:00:00+00

# TINT with date and time
query I
SELECT TINT(42, '2023-01-01 12:00:00'::TIMESTAMPTZ) as tint;
----
42@2023-01-01 12:00:00+00

# TINT with date and time and timezone
query I
SELECT TINT(42, '2023-01-01 12:00:00+05'::TIMESTAMPTZ) as tint;
----
42@2023-01-01 07:00:00+00

# TINT getValue
query I
SELECT getValue(TINT(42, '2023-01-01 12:00:00'::TIMESTAMPTZ)) as value;
----
42

# TINT asText without timezone
query I
SELECT asText(TINT(42, '2023-01-01 12:00:00'::TIMESTAMPTZ)) as str;
----
42@2023-01-01 12:00:00+00

# TINT asText with timezone
query I
SELECT asText(TINT(42, '2023-01-01 12:00:00+07'::TIMESTAMPTZ)) as str;
----
42@2023-01-01 05:00:00+00

# TINT cast with only date
query I
SELECT '15@2025-01-01'::TINT as tint;
----
15@2025-01-01 00:00:00+00

# TINT cast with date and time
query I
SELECT '100@2025-01-01 15:00:00'::TINT as tint;
----
100@2025-01-01 15:00:00+00

# TINT cast with date and time and timezone
query I
SELECT '100@2025-01-01 10:00:00+05'::TINT as tint;
----
100@2025-01-01 05:00:00+00

query I
SELECT tempSubtype('1@2025-01-01'::TINT) as tempType;
----
Instant

query I
SELECT interp('1@2000-01-01'::TINT) as interp;
----
None

query I
SELECT startValue('100@2000-01-01'::TINT) as startVal;
----
100

query I
SELECT endValue('100@2000-01-01'::TINT) as endVal;
----
100

query I
SELECT tintSeq([
    '1@2025-01-01 08:00:00'::TINT,
    '2@2025-01-01 08:10:00'::TINT,
    '3@2025-01-01 08:20:00'::TINT
    ]);