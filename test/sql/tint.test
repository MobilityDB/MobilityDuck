require mobilityduck

query I
SELECT '15@2025-01-01'::TINT as tint;
----
15@2025-01-01 00:00:00+00

query I
SELECT '100@2025-01-01 15:00:00'::TINT as tint;
----
100@2025-01-01 15:00:00+00

query I
SELECT '100@2025-01-01 10:00:00+05'::TINT as tint;
----
100@2025-01-01 05:00:00+00

query I
SELECT '{1@2025-01-01, 2@2025-01-02, 1@2025-01-03}'::TINT as tint;
----
{1@2025-01-01 00:00:00+00, 2@2025-01-02 00:00:00+00, 1@2025-01-03 00:00:00+00}

query I
SELECT '{[1@2025-01-01, 2@2025-01-02],[3@2025-01-04, 3@2025-01-05]}'::TINT as tint;
----
{[1@2025-01-01 00:00:00+00, 2@2025-01-02 00:00:00+00], [3@2025-01-04 00:00:00+00, 3@2025-01-05 00:00:00+00]}

query I
SELECT TINT(42, '2023-01-01'::TIMESTAMPTZ) as tint;
----
42@2023-01-01 00:00:00+00

query I
SELECT TINT(42, '2023-01-01 12:00:00'::TIMESTAMPTZ) as tint;
----
42@2023-01-01 12:00:00+00

query I
SELECT TINT(42, '2023-01-01 12:00:00+05'::TIMESTAMPTZ) as tint;
----
42@2023-01-01 07:00:00+00

query I
SELECT tempSubtype('1@2025-01-01'::TINT) as tempType;
----
Instant

query I
SELECT tempSubtype('{1@2025-01-01, 2@2025-01-02, 1@2025-01-03}'::TINT) as tempType;
----
Sequence

query I
SELECT tempSubtype('{[1@2025-01-01, 2@2025-01-02, 1@2025-01-03],[3@2025-01-04, 3@2025-01-05]}'::TINT) as tempType;
----
SequenceSet

query I
SELECT interp('1@2000-01-01'::TINT) as interp;
----
None

query I
SELECT interp('{1@2000-01-01, 2@2000-01-02, 1@2000-01-03}'::TINT) as interp;
----
Discrete

query I
SELECT interp('[1@2000-01-01, 2@2000-01-02, 1@2000-01-03]'::TINT) as interp;
----
Step

query I
SELECT interp('{[1@2000-01-01, 2@2000-01-02, 1@2000-01-03],[3@2000-01-04, 3@2000-01-05]}'::TINT) as interp;
----
Step

query I
SELECT getValue(TINT(42, '2023-01-01 12:00:00'::TIMESTAMPTZ)) as value;
----
42

query I
SELECT startValue('100@2000-01-01'::TINT) as startVal;
----
100

query I
SELECT startValue('{1@2000-01-01, 2@2000-01-02, 1@2000-01-03}'::TINT) as startVal;
----
1

query I
SELECT startValue('[1@2000-01-01, 2@2000-01-02, 1@2000-01-03]'::TINT) as startVal;
----
1

query I
SELECT startValue('{[1@2000-01-01, 2@2000-01-02, 1@2000-01-03],[3@2000-01-04, 3@2000-01-05]}'::TINT) as startVal;
----
1

query I
SELECT endValue('100@2000-01-01'::TINT) as endVal;
----
100

query I
SELECT endValue('{1@2000-01-01, 2@2000-01-02, 3@2000-01-03}'::TINT) as endVal;
----
3

query I
SELECT endValue('[4@2000-01-01, 5@2000-01-02, 6@2000-01-03]'::TINT) as endVal;
----
6

query I
SELECT endValue('{[1@2000-01-01, 2@2000-01-02, 3@2000-01-03], [4@2000-01-04, 6@2000-01-05]}'::TINT) as endVal;
----
6

query I
SELECT minValue('5@2000-01-01'::TINT) as minVal;
----
5

query I
SELECT minValue('{3@2000-01-01, 4@2000-01-02, 3@2000-01-03}'::TINT) as minVal;
----
3

query I
SELECT minValue('{[1@2000-01-01, 2@2000-01-02, 1@2000-01-03], [3@2000-01-04, 3@2000-01-05]}'::TINT) as minVal;
----
1

query I
SELECT maxValue('5@2000-01-01'::TINT) as maxVal;
----
5

query I
SELECT maxValue('{10@2000-01-01, 100@2000-01-02, 100@2000-01-03}'::TINT) as maxVal;
----
100

query I
SELECT maxValue('{[1@2000-01-01, 2@2000-01-02, 1@2000-01-03], [3@2000-01-04, 3@2000-01-05]}'::TINT) as maxVal;
----
3

query I
SELECT valueN('1@2000-01-01'::TINT, 1) as valN;
----
1

query I
SELECT valueN('1@2000-01-01'::TINT, 2) as valN;
----
NULL

query I
SELECT valueN('{4@2000-01-01, 6@2000-01-02, 3@2000-01-03}'::TINT, 2) as valN;
----
6

query I
SELECT valueN('{[9@2000-01-01, 2@2000-01-02, 3@2000-01-03], [5@2000-01-04, 8@2000-01-05]}'::TINT, 5) as valN;
----
8

query I
SELECT minInstant('1@2000-01-01'::TINT) as minInst;
----
1@2000-01-01 00:00:00+00

query I
SELECT minInstant('{1@2000-01-01, 2@2000-01-02, 1@2000-01-03}'::TINT) as minInst;
----
1@2000-01-01 00:00:00+00

query I
SELECT minInstant('{[1@2000-01-01, 2@2000-01-02, 1@2000-01-03], [3@2000-01-04, 3@2000-01-05]}'::TINT) as minInst;
----
1@2000-01-01 00:00:00+00

query I
SELECT maxInstant('1@2000-01-01'::TINT) as maxInst;
----
1@2000-01-01 00:00:00+00

query I
SELECT maxInstant('{1@2000-01-01, 2@2000-01-02, 1@2000-01-03}'::TINT) as maxInst;
----
2@2000-01-02 00:00:00+00

query I
SELECT maxInstant('{[1@2000-01-01, 2@2000-01-02, 1@2000-01-03], [3@2000-01-04, 3@2000-01-05]}'::TINT) as maxInst;
----
3@2000-01-04 00:00:00+00

query I
SELECT getTimestamp('1@2000-01-01'::TINT) as ts;
----
2000-01-01 00:00:00+00

query I
SELECT getTime(tint '{[1@2000-01-01, 2@2000-01-02, 1@2000-01-03],[3@2000-01-04, 3@2000-01-05]}');
----
{[2000-01-01 00:00:00+00, 2000-01-03 00:00:00+00], [2000-01-04 00:00:00+00, 2000-01-05 00:00:00+00]}

query I
SELECT duration('1@2000-01-01'::TINT, true) as duration;
----
00:00:00

query I
SELECT duration('{1@2000-01-01 12:00:00, 2@2000-01-01 13:00:00}'::TINT, true) as duration;
----
01:00:00

query I
SELECT duration('{1@2000-01-01, 2@2000-01-02, 1@2000-01-03}'::TINT, true) as duration;
----
2 days

query I
SELECT duration('{[1@2000-01-01, 2@2000-01-02, 1@2000-01-03], [3@2000-01-04, 3@2000-01-05]}'::TINT, true) as duration;
----
4 days

query I
SELECT tintSeq(['50@2025-01-01 08:00:00'::TINT]) as tint_seq;
----
[50@2025-01-01 08:00:00+00]

query I
SELECT tintSeq([
    '1@2025-01-01 08:00:00'::TINT,
    '2@2025-01-01 08:10:00'::TINT,
    '3@2025-01-01 08:20:00'::TINT
    ]) as tint_seq;
----
[1@2025-01-01 08:00:00+00, 2@2025-01-01 08:10:00+00, 3@2025-01-01 08:20:00+00]

query I
SELECT tintSeq([
    tint(1, '2025-01-01 08:00:00'::timestamptz),
    tint(2, '2025-01-01 08:10:00'::timestamptz),
    tint(3, '2025-01-01 08:20:00'::timestamptz)
    ]) as tint_seq;
----
[1@2025-01-01 08:00:00+00, 2@2025-01-01 08:10:00+00, 3@2025-01-01 08:20:00+00]

query I
SELECT tintSeqSet([
    tintSeq([
        tint(1, '2012-01-01 08:00:00'::timestamptz),
        tint(2, '2012-01-01 08:10:00'::timestamptz),
        tint(3, '2012-01-01 08:20:00'::timestamptz)
    ]),
    tintSeq([
        tint(1, '2012-01-01 09:00:00'::timestamptz),
        tint(2, '2012-01-01 09:10:00'::timestamptz),
        tint(1, '2012-01-01 09:20:00'::timestamptz)
    ])]) as tint_seq_set;
----
{[1@2012-01-01 08:00:00+00, 2@2012-01-01 08:10:00+00, 3@2012-01-01 08:20:00+00], [1@2012-01-01 09:00:00+00, 2@2012-01-01 09:10:00+00, 1@2012-01-01 09:20:00+00]}

query I
SELECT tintSeqSet(['[1@2000-01-01, 1@2000-01-02]'::TINT, '[2@2000-01-03, 2@2000-01-04]'::TINT]) as tint_seq_set;
----
{[1@2000-01-01 00:00:00+00, 1@2000-01-02 00:00:00+00], [2@2000-01-03 00:00:00+00, 2@2000-01-04 00:00:00+00]}

query I
SELECT tintSeq(tint '1@2000-01-01');
----
[1@2000-01-01 00:00:00+00]

query I
SELECT tintSeq(tint '{1@2000-01-01}');
----
{1@2000-01-01 00:00:00+00}

query I
SELECT tintSeq(tint '{1@2000-01-01, 2@2000-01-02, 1@2000-01-03}');
----
{1@2000-01-01 00:00:00+00, 2@2000-01-02 00:00:00+00, 1@2000-01-03 00:00:00+00}

query I
SELECT timeSpan(tint '1@2000-01-01');
----
[2000-01-01 00:00:00+00, 2000-01-01 00:00:00+00]

query I
SELECT timeSpan(tint '{1@2000-01-01, 2@2000-01-02, 1@2000-01-03}');
----
[2000-01-01 00:00:00+00, 2000-01-03 00:00:00+00]

query I
SELECT timeSpan(tint '{[1@2000-01-01, 2@2000-01-02, 1@2000-01-03],[3@2000-01-04, 3@2000-01-05]}');
----
[2000-01-01 00:00:00+00, 2000-01-05 00:00:00+00]

query I
SELECT valueSpan(tint '{[1@2001-01-01, 1@2001-01-03), [4@2001-01-03, 6@2001-01-05]}');
----
[1, 7)

query I
SELECT valueSet(tint '1@2000-01-01');
----
{1}

query I
SELECT valueSet(tint '{1@2000-01-01, 2@2000-01-02, 1@2000-01-03}');
----
{1, 2}

query I
SELECT valueSet(tint '{[1@2000-01-01, 2@2000-01-02, 1@2000-01-03],[3@2000-01-04, 3@2000-01-05]}');
----
{1, 2, 3}

query I
SELECT sequences(tint '[1@2000-01-01, 2@2000-01-02, 1@2000-01-03]');
----
['[1@2000-01-01 00:00:00+00, 2@2000-01-02 00:00:00+00, 1@2000-01-03 00:00:00+00]']

query I
SELECT sequences(tint '{[1@2000-01-01], [3@2000-01-04, 3@2000-01-05]}');
----
['[1@2000-01-01 00:00:00+00]', '[3@2000-01-04 00:00:00+00, 3@2000-01-05 00:00:00+00]']

query I
SELECT startTimestamp(tint '1@2000-01-01');
----
2000-01-01 00:00:00+00

query I
SELECT startTimestamp(tint '{1@2000-01-01, 2@2000-01-02, 1@2000-01-03}');
----
2000-01-01 00:00:00+00

query I
SELECT startTimestamp(tint '{[1@2000-01-01, 2@2000-01-02, 1@2000-01-03],[3@2000-01-04, 3@2000-01-05]}');
----
2000-01-01 00:00:00+00

query I
SELECT atTime(tint '{[1@2000-01-01, 2@2000-01-02, 1@2000-01-03],[3@2000-01-04, 3@2000-01-05]}', tstzspan '[2000-01-01,2000-01-02]');
----
{[1@2000-01-01 00:00:00+00, 2@2000-01-02 00:00:00+00]}

query I
SELECT atTime(tint '{[1@2000-01-01, 2@2000-01-02, 1@2000-01-03],[3@2000-01-04, 3@2000-01-05]}', tstzspanset '{[2000-01-01,2000-01-02]}');
----
{[1@2000-01-01 00:00:00+00, 2@2000-01-02 00:00:00+00]}

query I
SELECT shiftValue(tint '{1@2001-01-01, 2@2001-01-03, 1@2001-01-05}', 100);
----
{101@2001-01-01 00:00:00+00, 102@2001-01-03 00:00:00+00, 101@2001-01-05 00:00:00+00}

query I
SELECT scaleValue(tint '1@2001-01-01', 5);
----
1@2001-01-01 00:00:00+00

query I
SELECT shiftScaleValue(tint '1@2001-01-01', 1, 5);
----
2@2001-01-01 00:00:00+00